
# 処方箋スキャン - AIお薬管理アプリ

紙の処方箋をカメラで撮影するだけで、お薬の情報をAIが自動で読み取り、在庫や履歴を簡単に管理できるWebアプリケーションです。

## 概要

このアプリケーションは、GoogleのGemini APIを活用して、処方箋の画像からテキスト情報を高精度に抽出します。ユーザーは撮影した処方箋の内容を確認・修正し、保存するだけで、現在服用中のお薬の在庫（残り日数）や過去の処方履歴を手軽に管理できます。日々の服薬管理の負担を軽減し、よりシンプルで安心な体験を提供することを目的としています。

## ✨ 主な機能

- **処方箋スキャン**: モバイルデバイスではカメラを直接起動し、処方箋をその場で撮影できます。PCではファイル選択ダイアログが開きます。
- **写真から読み込み**: 保存済みの処方箋画像を選択して読み込むことも可能です。
- **AI-OCRによる情報抽出**: Gemini API (`gemini-2.5-flash`) が処方箋画像から以下の情報を自動で読み取ります。**AIには処方箋に書かれている情報を計算・推測せず、そのまま抽出するよう指示されています。**
  - **処方日**: 処方箋が発行された日付
  - **薬剤名**: 規格（強さ）まで含んだ正式名称 (例: `タケキャブ錠20mg`)
  - **用法・用量**: 服用に関する指示を、**処方箋の記載通りに**抽出します (例: `1日3回毎食後 1日6錠`)。
  - **処方日数**: 処方された日数 (例: `14日分`)
- **確認・修正画面**: AIの読み取り結果と元の画像を並べて表示。ユーザーは内容を確認し、必要に応じて簡単に手動修正が可能です。
- **お薬の在庫管理**: 保存されたデータに基づき、服用期間内のお薬を「残り日数が少ない順」に一覧表示。在庫が一目でわかります。
- **処方履歴**: 過去に登録したすべての処方箋を時系列（新しい順）で確認できます。
- **レスポンシブデザイン**: PC、タブレット、スマートフォンなど、様々なデバイスの画面サイズに最適化されています。

## 🛠️ 技術スタック

- **フロントエンド**: React, TypeScript, Tailwind CSS
- **AI / OCR**: Google Gemini API (`gemini-2.5-flash`)
- **モジュール管理**: esm.sh (CDN経由でのESMモジュール利用)
- **動作環境**: Webブラウザ

## 🚀 実行方法

このアプリケーションは、ビルドプロセスを必要とせず、Webサーバー上で`index.html`をホストするだけで動作するように設計されています。

1.  **APIキーの設定**: アプリケーションは環境変数 `process.env.API_KEY` からGoogle Gemini APIのキーを読み込みます。アプリケーションをホストする環境で、この環境変数を事前に設定してください。
2.  **ブラウザで開く**: `index.html`ファイルにアクセスすると、アプリケーションが起動します。

---

## 🤖 AIへの初期プロンプト例

以下は、このアプリケーションの土台をAIに生成させるために使用できる初期プロンプトの例です。

---

ReactとTypeScript、Tailwind CSSを使用して、以下の仕様で「紙の処方箋管理アプリ」を作成してください。

**アプリの目的:**
ユーザーが紙の処方箋をカメラで撮影するだけで、薬の情報を簡単にデジタル化し、在庫や履歴を管理できるようにする。

**主要機能:**
1.  **ホーム画面:**
    *   現在服用中の薬（在庫）を「残り日数が少ない順」で一覧表示する。各項目には薬剤名、用法・用量、残り日数を表示。
    *   在庫がない場合はその旨を表示する。
    *   画面右下にフローティングアクションボタンとして「カメラ撮影」と「写真から選択」の2つのボタンを配置する。

2.  **処方箋の読み取りと修正画面:**
    *   選択された処方箋画像をGoogle Gemini API (`gemini-2.5-flash`) に送信し、AI-OCRで以下の情報をJSON形式で抽出する。**AIには、処方箋に書かれた情報を計算・推測せず、そのまま抽出するように厳格に指示すること。**
        * `処方日` (YYYY-MM-DD)
        * `薬剤名` (規格を含む。例: タケキャブ錠20mg)
        * `用法・用量` (服用指示全体。例: `1日3回毎食後 1日6錠`)
        * `日数`
    *   薬剤は処方箋に書かれた順番を維持すること。
    *   読み取り中は「AIが処方箋を読み取り中...」といったメッセージを含むモーダルローディング画面を表示する。
    *   読み取り後、左に処方箋画像、右に抽出されたデータが入力されたフォームを表示する「確認・修正画面」に遷移する。
    *   ユーザーはフォームの内容を修正できる。「保存」でデータをアプリ内に保存しホーム画面に戻る。「キャンセル」で何もせずホーム画面に戻る。

3.  **履歴画面:**
    *   過去に保存した全ての処方箋を「処方日が新しい順」で一覧表示する。

4.  **共通ヘッダー:**
    *   アプリタイトル「処方箋スキャン」を表示する。
    *   「ホーム」と「履歴」を切り替えるナビゲーションボタンを配置する。

**技術要件:**
*   `index.html` と `index.tsx` を使用したシングルページアプリケーションとして構築する。
*   Reactや`@google/genai`などのライブラリは、`index.html`の`importmap`機能を用いてesm.sh経由で読み込む。
*   Gemini APIのAPIキーは `process.env.API_KEY` から取得することを前提とする。
*   UIはクリーンで直感的なデザインにすること。アイコンを効果的に使用して視認性を高める。
*   状態管理にはReactの `useState` を使用し、コンポーネントは機能ごとに適切に分割する (`HomeScreen.tsx`, `CorrectionScreen.tsx`, `HistoryScreen.tsx`, `services/geminiService.ts`など)。
*   画像選択・カメラアクセスには `<input type="file">` を使用する。モバイルでのカメラ直接起動には `capture="environment"` 属性を利用する。